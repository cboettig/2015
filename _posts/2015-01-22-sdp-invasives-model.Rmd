---
layout: post
code: true
category: ecology
tags: 
- pdg-control
---


```{r}
devtools::install_github("cboettig/pdg_control")
```

```{r settings}
library(knitr)
library(pdgControl)
library(ggplot2)
opts_chunk$set(dev='svg', fig.width=5, fig.height=5, cache=1,results='hide')
```


## Reed solution

```{r params}
f <- function(x, h, p) p[[1]] * x / {1 + p[[2]] * x} * (1 - h)
p <- c(a = 6, b = 0.05)
profit <- 
x_grid <- seq(xmin, xmax, length = grid_n)
h_grid <- x_grid
delta <- 0.05
xT <- 0
OptTime <- 25
sigma_g <- 0.1
z_g <- function() 1 + rlnorm(1, 0, sigma_g)
pdfn <- function(P, s) dlnorm(P, 0, s)
```


```{r}
SDP_Mat <- determine_SDP_matrix(f, p, x_grid, h_grid, sigma_g, pdfn)
```

```{r}
opt <- value_iteration(SDP_Mat, x_grid, h_grid, OptTime = 1000, xT, profit, delta)
```

Which gives optimal escapement $S$ at `r opt$S`.

```{r}
qplot(seq_along(opt$D), opt$D)
```


